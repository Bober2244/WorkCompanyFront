{"ast":null,"code":"import { reactive } from \"vue\";\nconst store = reactive({\n  cartItems: [],\n  userId: sessionStorage.getItem('userId'),\n  // Загрузка корзины (состояние корзины будет чисто на фронте)\n  async loadCart() {\n    try {\n      const response = await fetch(`http://localhost:8000/api/carts?user_id=${this.userId}`);\n      if (!response.ok) {\n        throw new Error(\"Не удалось загрузить корзину\");\n      }\n      const data = await response.json();\n      console.log('Cart data:', data);\n\n      // Загружаем товары в корзину без количества\n      this.cartItems = data.map(cartItem => ({\n        id: cartItem.id,\n        item_id: cartItem.item_id,\n        title: cartItem.item.title,\n        price: cartItem.item.price,\n        size: cartItem.size,\n        quantity: 1 // Изначально количество = 1\n      }));\n\n      console.log(\"Loaded cart items:\", this.cartItems);\n    } catch (error) {\n      console.error(\"Ошибка при загрузке корзины:\", error);\n    }\n  },\n  // Метод для обновления количества товара в корзине\n  updateCartItemQuantity(itemId, quantity) {\n    const item = this.cartItems.find(item => item.id === itemId);\n    if (item) {\n      item.quantity = quantity;\n    }\n  },\n  // Метод для увеличения количества товара\n  incrementQuantity(itemId) {\n    const item = this.cartItems.find(item => item.id === itemId);\n    if (item) {\n      item.quantity += 1;\n    }\n  },\n  // Метод для уменьшения количества товара\n  decrementQuantity(itemId) {\n    const item = this.cartItems.find(item => item.id === itemId);\n    if (item && item.quantity > 1) {\n      item.quantity -= 1;\n    }\n  },\n  // Рассчитываем общую цену\n  get totalPrice() {\n    return this.cartItems.reduce((sum, item) => sum + item.price * item.quantity, 0);\n  },\n  // Рассчитываем общее количество товаров\n  get totalItems() {\n    return this.cartItems.reduce((count, item) => count + item.quantity, 0);\n  }\n});\nexport default store;","map":{"version":3,"names":["reactive","store","cartItems","userId","sessionStorage","getItem","loadCart","response","fetch","ok","Error","data","json","console","log","map","cartItem","id","item_id","title","item","price","size","quantity","error","updateCartItemQuantity","itemId","find","incrementQuantity","decrementQuantity","totalPrice","reduce","sum","totalItems","count"],"sources":["/Users/nicolassergeev/WebstormProjects/frontend-ShoesShop/src/store.js"],"sourcesContent":["import { reactive } from \"vue\";\n\nconst store = reactive({\n    cartItems: [],\n    userId: sessionStorage.getItem('userId'),\n\n    // Загрузка корзины (состояние корзины будет чисто на фронте)\n    async loadCart() {\n        try {\n            const response = await fetch(`http://localhost:8000/api/carts?user_id=${this.userId}`);\n            if (!response.ok) {\n                throw new Error(\"Не удалось загрузить корзину\");\n            }\n            const data = await response.json();\n            console.log('Cart data:', data);\n\n            // Загружаем товары в корзину без количества\n            this.cartItems = data.map(cartItem => ({\n                id: cartItem.id,\n                item_id: cartItem.item_id,\n                title: cartItem.item.title,\n                price: cartItem.item.price,\n                size: cartItem.size,\n                quantity: 1,  // Изначально количество = 1\n            }));\n\n            console.log(\"Loaded cart items:\", this.cartItems);\n        } catch (error) {\n            console.error(\"Ошибка при загрузке корзины:\", error);\n        }\n    },\n\n    // Метод для обновления количества товара в корзине\n    updateCartItemQuantity(itemId, quantity) {\n        const item = this.cartItems.find(item => item.id === itemId);\n        if (item) {\n            item.quantity = quantity;\n        }\n    },\n\n    // Метод для увеличения количества товара\n    incrementQuantity(itemId) {\n        const item = this.cartItems.find(item => item.id === itemId);\n        if (item) {\n            item.quantity += 1;\n        }\n    },\n\n    // Метод для уменьшения количества товара\n    decrementQuantity(itemId) {\n        const item = this.cartItems.find(item => item.id === itemId);\n        if (item && item.quantity > 1) {\n            item.quantity -= 1;\n        }\n    },\n\n    // Рассчитываем общую цену\n    get totalPrice() {\n        return this.cartItems.reduce((sum, item) => sum + item.price * item.quantity, 0);\n    },\n\n    // Рассчитываем общее количество товаров\n    get totalItems() {\n        return this.cartItems.reduce((count, item) => count + item.quantity, 0);\n    },\n});\n\nexport default store;\n"],"mappings":"AAAA,SAASA,QAAQ,QAAQ,KAAK;AAE9B,MAAMC,KAAK,GAAGD,QAAQ,CAAC;EACnBE,SAAS,EAAE,EAAE;EACbC,MAAM,EAAEC,cAAc,CAACC,OAAO,CAAC,QAAQ,CAAC;EAExC;EACA,MAAMC,QAAQA,CAAA,EAAG;IACb,IAAI;MACA,MAAMC,QAAQ,GAAG,MAAMC,KAAK,CAAE,2CAA0C,IAAI,CAACL,MAAO,EAAC,CAAC;MACtF,IAAI,CAACI,QAAQ,CAACE,EAAE,EAAE;QACd,MAAM,IAAIC,KAAK,CAAC,8BAA8B,CAAC;MACnD;MACA,MAAMC,IAAI,GAAG,MAAMJ,QAAQ,CAACK,IAAI,CAAC,CAAC;MAClCC,OAAO,CAACC,GAAG,CAAC,YAAY,EAAEH,IAAI,CAAC;;MAE/B;MACA,IAAI,CAACT,SAAS,GAAGS,IAAI,CAACI,GAAG,CAACC,QAAQ,KAAK;QACnCC,EAAE,EAAED,QAAQ,CAACC,EAAE;QACfC,OAAO,EAAEF,QAAQ,CAACE,OAAO;QACzBC,KAAK,EAAEH,QAAQ,CAACI,IAAI,CAACD,KAAK;QAC1BE,KAAK,EAAEL,QAAQ,CAACI,IAAI,CAACC,KAAK;QAC1BC,IAAI,EAAEN,QAAQ,CAACM,IAAI;QACnBC,QAAQ,EAAE,CAAC,CAAG;MAClB,CAAC,CAAC,CAAC;;MAEHV,OAAO,CAACC,GAAG,CAAC,oBAAoB,EAAE,IAAI,CAACZ,SAAS,CAAC;IACrD,CAAC,CAAC,OAAOsB,KAAK,EAAE;MACZX,OAAO,CAACW,KAAK,CAAC,8BAA8B,EAAEA,KAAK,CAAC;IACxD;EACJ,CAAC;EAED;EACAC,sBAAsBA,CAACC,MAAM,EAAEH,QAAQ,EAAE;IACrC,MAAMH,IAAI,GAAG,IAAI,CAAClB,SAAS,CAACyB,IAAI,CAACP,IAAI,IAAIA,IAAI,CAACH,EAAE,KAAKS,MAAM,CAAC;IAC5D,IAAIN,IAAI,EAAE;MACNA,IAAI,CAACG,QAAQ,GAAGA,QAAQ;IAC5B;EACJ,CAAC;EAED;EACAK,iBAAiBA,CAACF,MAAM,EAAE;IACtB,MAAMN,IAAI,GAAG,IAAI,CAAClB,SAAS,CAACyB,IAAI,CAACP,IAAI,IAAIA,IAAI,CAACH,EAAE,KAAKS,MAAM,CAAC;IAC5D,IAAIN,IAAI,EAAE;MACNA,IAAI,CAACG,QAAQ,IAAI,CAAC;IACtB;EACJ,CAAC;EAED;EACAM,iBAAiBA,CAACH,MAAM,EAAE;IACtB,MAAMN,IAAI,GAAG,IAAI,CAAClB,SAAS,CAACyB,IAAI,CAACP,IAAI,IAAIA,IAAI,CAACH,EAAE,KAAKS,MAAM,CAAC;IAC5D,IAAIN,IAAI,IAAIA,IAAI,CAACG,QAAQ,GAAG,CAAC,EAAE;MAC3BH,IAAI,CAACG,QAAQ,IAAI,CAAC;IACtB;EACJ,CAAC;EAED;EACA,IAAIO,UAAUA,CAAA,EAAG;IACb,OAAO,IAAI,CAAC5B,SAAS,CAAC6B,MAAM,CAAC,CAACC,GAAG,EAAEZ,IAAI,KAAKY,GAAG,GAAGZ,IAAI,CAACC,KAAK,GAAGD,IAAI,CAACG,QAAQ,EAAE,CAAC,CAAC;EACpF,CAAC;EAED;EACA,IAAIU,UAAUA,CAAA,EAAG;IACb,OAAO,IAAI,CAAC/B,SAAS,CAAC6B,MAAM,CAAC,CAACG,KAAK,EAAEd,IAAI,KAAKc,KAAK,GAAGd,IAAI,CAACG,QAAQ,EAAE,CAAC,CAAC;EAC3E;AACJ,CAAC,CAAC;AAEF,eAAetB,KAAK"},"metadata":{},"sourceType":"module","externalDependencies":[]}