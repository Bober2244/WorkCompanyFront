{"ast":null,"code":"import { resolveComponent as _resolveComponent, createVNode as _createVNode, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, vModelSelect as _vModelSelect, withDirectives as _withDirectives, createCommentVNode as _createCommentVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-73274f66\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  class: \"product-detail-container\"\n};\nconst _hoisted_2 = {\n  class: \"product-detail\"\n};\nconst _hoisted_3 = {\n  class: \"image-slider-wrapper\"\n};\nconst _hoisted_4 = {\n  class: \"product-info\"\n};\nconst _hoisted_5 = {\n  class: \"price\"\n};\nconst _hoisted_6 = {\n  class: \"size-selection\"\n};\nconst _hoisted_7 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"h2\", null, \"Выберите размер:\", -1 /* HOISTED */));\nconst _hoisted_8 = [\"value\"];\nconst _hoisted_9 = {\n  class: \"description\"\n};\nconst _hoisted_10 = {\n  class: \"quantity-control\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_AppHeader = _resolveComponent(\"AppHeader\");\n  const _component_ImageSlider = _resolveComponent(\"ImageSlider\");\n  const _component_AppFooter = _resolveComponent(\"AppFooter\");\n  return _openBlock(), _createElementBlock(_Fragment, null, [_createVNode(_component_AppHeader), _createElementVNode(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"div\", _hoisted_3, [_createVNode(_component_ImageSlider, {\n    images: _ctx.product.images,\n    \"auto-slide-interval\": 3000\n  }, null, 8 /* PROPS */, [\"images\"])]), _createElementVNode(\"div\", _hoisted_4, [_createElementVNode(\"h1\", null, _toDisplayString(_ctx.product.title), 1 /* TEXT */), _createElementVNode(\"p\", _hoisted_5, \"Цена: \" + _toDisplayString(_ctx.product.price) + \" руб.\", 1 /* TEXT */), _createElementVNode(\"div\", _hoisted_6, [_hoisted_7, _withDirectives(_createElementVNode(\"select\", {\n    class: \"size-dropdown\",\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => _ctx.selectedSize = $event)\n  }, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.product.sizes, size => {\n    return _openBlock(), _createElementBlock(\"option\", {\n      key: size,\n      value: size\n    }, _toDisplayString(size), 9 /* TEXT, PROPS */, _hoisted_8);\n  }), 128 /* KEYED_FRAGMENT */))], 512 /* NEED_PATCH */), [[_vModelSelect, _ctx.selectedSize]])]), _createElementVNode(\"p\", _hoisted_9, _toDisplayString(_ctx.product.description), 1 /* TEXT */), _createCommentVNode(\" Количество товара \"), _createElementVNode(\"div\", _hoisted_10, [_createElementVNode(\"button\", {\n    onClick: _cache[1] || (_cache[1] = $event => _ctx.decrementQuantity(_ctx.product.id)),\n    class: \"quantity-btn\"\n  }, \"-\"), _createElementVNode(\"span\", null, _toDisplayString(_ctx.getQuantity(_ctx.product.id)), 1 /* TEXT */), _createElementVNode(\"button\", {\n    onClick: _cache[2] || (_cache[2] = $event => _ctx.incrementQuantity(_ctx.product.id)),\n    class: \"quantity-btn\"\n  }, \"+\")]), _createElementVNode(\"button\", {\n    onClick: _cache[3] || (_cache[3] = (...args) => _ctx.addToCart && _ctx.addToCart(...args)),\n    class: \"form__button\"\n  }, \"Добавить в корзину за \" + _toDisplayString(_ctx.product.price) + \" руб.\", 1 /* TEXT */)])])]), _createVNode(_component_AppFooter)], 64 /* STABLE_FRAGMENT */);\n}","map":{"version":3,"mappings":";;;EAEOA,KAAK,EAAC;AAA0B;;EAC9BA,KAAK,EAAC;AAAgB;;EACpBA,KAAK,EAAC;AAAsB;;EAG5BA,KAAK,EAAC;AAAc;;EAEpBA,KAAK,EAAC;AAAO;;EAEXA,KAAK,EAAC;AAAgB;gEACzBC,oBAAyB,YAArB,kBAAgB;;;EAenBD,KAAK,EAAC;AAAa;;EAGjBA,KAAK,EAAC;AAAkB;;;;;6DA7BnCE,aAAuBC,uBACvBF,oBAqCM,OArCNG,UAqCM,GApCJH,oBAmCM,OAnCNI,UAmCM,GAlCJJ,oBAEM,OAFNK,UAEM,GADJJ,aAAoEK;IAAtDC,MAAM,EAAEC,YAAO,CAACD,MAAM;IAAG,qBAAmB,EAAE;yCAE9DP,oBA8BM,OA9BNS,UA8BM,GA7BJT,oBAA4B,6BAArBQ,YAAO,CAACE,KAAK,kBACpBV,oBAAmD,KAAnDW,UAAmD,EAAlC,QAAM,oBAAGH,YAAO,CAACI,KAAK,IAAG,OAAK,iBAE/CZ,oBAcM,OAdNa,UAcM,GAbJC,UAAyB,kBACzBd,oBAWS;IAVLD,KAAK,EAAC,eAAe;+DACZS,iBAAY;yBAEvBO,oBAMSC,6BALUR,YAAO,CAACS,KAAK,EAArBC,IAAI;yBADfH,oBAMS;MAJJI,GAAG,EAAED,IAAI;MACTE,KAAK,EAAEF;wBAEPA,IAAI;2EAPEV,iBAAY,OAY3BR,oBAAoD,KAApDqB,UAAoD,mBAA1Bb,YAAO,CAACc,WAAW,kBAE7CC,0CAA0B,EAC1BvB,oBAIM,OAJNwB,WAIM,GAHJxB,oBAA8E;IAArEyB,OAAK,sCAAEjB,sBAAiB,CAACA,YAAO,CAACkB,EAAE;IAAG3B,KAAK,EAAC;KAAe,GAAC,GACrEC,oBAA0C,+BAAjCQ,gBAAW,CAACA,YAAO,CAACkB,EAAE,mBAC/B1B,oBAA8E;IAArEyB,OAAK,sCAAEjB,sBAAiB,CAACA,YAAO,CAACkB,EAAE;IAAG3B,KAAK,EAAC;KAAe,GAAC,KAGvEC,oBAAuG;IAA9FyB,OAAK,yCAAEjB,yCAAS;IAAET,KAAK,EAAC;KAAe,wBAAsB,oBAAGS,YAAO,CAACI,KAAK,IAAG,OAAK,uBAIpGX,aAAuB0B","names":["class","_createElementVNode","_createVNode","_component_AppHeader","_hoisted_1","_hoisted_2","_hoisted_3","_component_ImageSlider","images","_ctx","_hoisted_4","title","_hoisted_5","price","_hoisted_6","_hoisted_7","_createElementBlock","_Fragment","sizes","size","key","value","_hoisted_9","description","_createCommentVNode","_hoisted_10","onClick","id","_component_AppFooter"],"sourceRoot":"","sources":["/Users/nicolassergeev/WebstormProjects/frontend-ShoesShop/src/components/CartShop.vue"],"sourcesContent":["<template>\n  <AppHeader></AppHeader>\n  <div class=\"product-detail-container\">\n    <div class=\"product-detail\">\n      <div class=\"image-slider-wrapper\">\n        <ImageSlider :images=\"product.images\" :auto-slide-interval=\"3000\" />\n      </div>\n      <div class=\"product-info\">\n        <h1>{{ product.title }}</h1>\n        <p class=\"price\">Цена: {{ product.price }} руб.</p>\n\n        <div class=\"size-selection\">\n          <h2>Выберите размер:</h2>\n          <select\n              class=\"size-dropdown\"\n              v-model=\"selectedSize\"\n          >\n            <option\n                v-for=\"size in product.sizes\"\n                :key=\"size\"\n                :value=\"size\"\n            >\n              {{ size }}\n            </option>\n          </select>\n        </div>\n\n        <p class=\"description\">{{ product.description }}</p>\n\n        <!-- Количество товара -->\n        <div class=\"quantity-control\">\n          <button @click=\"decrementQuantity(product.id)\" class=\"quantity-btn\">-</button>\n          <span>{{ getQuantity(product.id) }}</span>\n          <button @click=\"incrementQuantity(product.id)\" class=\"quantity-btn\">+</button>\n        </div>\n\n        <button @click=\"addToCart\" class=\"form__button\">Добавить в корзину за {{ product.price }} руб.</button>\n      </div>\n    </div>\n  </div>\n  <AppFooter></AppFooter>\n</template>\n\n\n<script>\nimport store from '@/store';\nimport ModalWindow from \"@/components/ModalWindow.vue\";\nimport axios from \"axios\"; // импортируем store.js\n\nexport default {\n  components: {ModalWindow},\n  props: {\n    isOpen: {\n      type: Boolean,\n      required: true,\n    },\n  },\n  data() {\n    return {\n      itemIdToRemove: null,\n      itemSizeToRemove: null,\n    };\n  },\n  emits: [\"close\"],\n  async mounted() {\n    await store.loadCart(); // Загружаем корзину при монтировании компонента\n  },\n  computed: {\n    cartItems() {\n      return store.cartItems; // Получаем список товаров из store\n    },\n    totalPrice() {\n      return store.totalPrice; // Считаем общую цену через store\n    },\n    totalItems() {\n      return store.totalItems; // Получаем общее количество товаров из store\n    },\n  },\n  methods: {\n    closeCart() {\n      this.$emit(\"close\");\n    },\n    showModal(itemId, size) {\n      this.itemIdToRemove = itemId;\n      this.itemSizeToRemove = size;\n      this.$refs.confirmationModal.openModal();\n    },\n    async removeItem() {\n      try {\n        const userId = sessionStorage.getItem(\"userId\");\n        const itemId = this.itemIdToRemove;\n        const size = this.itemSizeToRemove;\n\n        if (!userId) {\n          console.error(\"User is not authenticated\");\n          return;\n        }\n        const url = `http://localhost:8000/api/carts?user_id=${userId}&item_id=${itemId}&size=${size}`;\n        console.log(url)\n        const response = await axios.delete(url);\n\n        if (response.status === 200) {\n\n          this.$emit('item-removed', itemId);\n          window.location.reload();\n        } else {\n          console.error('Error removing item from cart:', response.data.message);\n        }\n      } catch (error) {\n        console.error('Error removing item from cart:', error);\n      }\n    },\n    async goToPayment() {\n      const userId = sessionStorage.getItem(\"userId\");\n      try {\n        // Отправляем запрос на создание платежа\n        const paymentResponse = await axios.post('http://localhost:8000/api/payments', {\n          amount: String(this.totalPrice),\n          description: \"Payment for cart items\"\n        });\n\n        // Получаем URL для редиректа на YooKassa\n        const confirmationUrl = paymentResponse.data.confirmation_url;\n\n        if (confirmationUrl) {\n          await axios.delete(`http://localhost:8000/api/carts/all?user_id=${userId}`);\n          window.location.href = confirmationUrl;\n        } else {\n          console.error('No confirmation URL received');\n        }\n      } catch (error) {\n        console.error('Error initiating payment:', error);\n      }\n    },\n\n\n  },\n};\n</script>\n\n<style scoped>\n.item-title-link {\n  text-decoration: none;\n  color: #333;\n}\n\n.item-title-link:hover {\n  color: #4caf50;\n}\n\n.cart-panel {\n  position: fixed;\n  top: 0;\n  right: 0;\n  width: 370px;\n  height: 100%;\n  background: #fff;\n  box-shadow: -2px 0 10px rgba(0, 0, 0, 0.2);\n  transform: translateX(100%);\n  transition: transform 0.3s ease;\n  z-index: 1000;\n}\n\n.cart-panel.open {\n  transform: translateX(0);\n}\n\n.cart-content {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  padding: 20px;\n  background-color: #f9f9f9;\n  border-radius: 10px;\n}\n\n.cart-header {\n  display: flex;\n  align-items: center;\n  margin-bottom: 15px;\n}\n\n.cart-icon {\n  width: 24px;\n  height: 24px;\n  margin-left: 10px;\n  margin-bottom: 7px;\n}\n\n.cart-items {\n  flex-grow: 1;\n  overflow-y: auto;\n}\n\n.cart-item {\n  display: flex;\n  justify-content: space-between;\n  padding: 12px 0;\n  border-bottom: 1px solid #ddd;\n  font-size: 16px;\n}\n\n.item-title {\n  font-weight: bold;\n  font-size: 16px;\n  color: #333;\n}\n\n.item-price {\n  color: #4caf50;\n  font-size: 16px;\n}\n\n.remove-button {\n  padding: 4px 8px;\n  background-color: transparent;\n  color: #f44336;\n  border: none;\n  cursor: pointer;\n  font-size: 18px;\n  font-weight: bold;\n  transition: color 0.2s;\n}\n\n.remove-button:hover {\n  color: #d32f2f;\n}\n\n.cart-footer {\n  margin-top: 20px;\n  text-align: center;\n}\n\n\n.close-button {\n  align-self: flex-end;\n  background: none;\n  border: none;\n  margin-left: 117px;\n  margin-bottom: 7px;\n  padding: 0;\n  cursor: pointer;\n  transition: transform 0.2s ease;\n}\n\n.close-button img {\n  width: 24px;\n  height: 24px;\n}\n\n.close-button:hover {\n  transform: scale(1.1);\n}\n\nh3 {\n  font-size: 20px;\n  color: #333;\n}\n\n.cart-footer p {\n  font-weight: bold;\n}\n\n.cart-items p {\n  color: #555;\n}\n\n.cart-items .cart-item p {\n  color: #333;\n}\n\n.item-size {\n  color: #555;\n  font-size: 14px; /* Меньший размер шрифта для размера */\n  margin-top: 4px;\n}\n\n.quantity-controls {\n  display: flex;\n  align-items: center;\n}\n\n.quantity-button {\n  padding: 5px 8px;\n  background-color: #f0f0f0;\n  border: 1px solid #ddd;\n  cursor: pointer;\n  font-size: 16px;\n  margin: 0;  /* Убрали отступы между кнопками */\n}\n\n.quantity {\n  font-size: 16px;\n  margin: 0 8px;  /* Оставили отступ между числом и кнопками */\n}\n</style>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}